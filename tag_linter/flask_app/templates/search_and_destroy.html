{% extends 'base.html' %}

{% block pagetitle %}
  Search & Destroy
{% endblock %}

{% block contenttitle %}
  Search & Destroy
{% endblock %}

{% block head_extra %}
  <script type="module">
    import {renderTagDropdown} from "/static/js/tags.js"
    import {destroy} from "/static/js/search_and_destroy.js"

    window.addEventListener('load', (e) => {
      renderTagDropdown("input_tag_service")
      var elemTagService = document.getElementById("input_tag_service")

      var elemTagName = document.getElementById("input_tag_name")
      var elemNamespaceMode = document.getElementById("input_namespace_mode")

      var elemInboxEnabled = document.getElementById("input_enable_inbox")
      var elemArchiveEnabled = document.getElementById("input_enable_archive")

      var elemDestroyButton = document.getElementById("destroy_button")

      async function submit() {}

      elemDestroyButton.onclick = function (e) {
        var tagName = elemTagName.value;
        var isNamespace = elemNamespaceMode.checked;

        destroy({
          inbox: elemInboxEnabled.checked,
          archive: elemArchiveEnabled.checked,
          tagName: elemTagName.value,
          tagService: elemTagService.value,
          namespaceMode: elemNamespaceMode.checked
        })
      }
    })
  </script>
{% endblock %}

{% block content %}
  <p>This feature will remove a tag or all tags of a namespace from a given tag service. Please note that this may run slowly, and that this process cannot be easily undone. You should create a backup of your database before proceeding, or otherwise be prepared for unforeseen consequences.</p>

  <p>To specify a namespace, type in the namespace without a trailing colon. For example, enter
    <code>species</code>
    to remove all
    <code>species:*</code>
    tags. Then, check the
    <code>This is a namespace</code>
    checkbox.</p>

  <label for="input_tag_service">Tag service:</label>
  <select id="input_tag_service"></select>
  <br/>
  <br/>
  <label for="input_tag_name">Tag:</label>
  <input id="input_tag_name" type="text"/>
  <br/>
  <input id="input_namespace_mode" type="checkbox"/>
  <label for="input_namespace_mode">This is a namespace</label>
  <br/>
  <br/>
  <input id="input_enable_inbox" type="checkbox" checked="true"/>
  <label for="input_enable_inbox">Enable Inbox</label>
  <br/>
  <input id="input_enable_archive" type="checkbox" checked="true"/>
  <label for="input_enable_archive">Enable Archive</label>
  <br/>
  <br/>
  <button id="destroy_button">
    <span class="icon_left icon_left_bomb">Destroy</span>
  </button>
{% endblock %}
